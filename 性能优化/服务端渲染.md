刚开始的时候很难理解，我一直以为自己做的项目就是在服务端渲染的，然后给到浏览器是一个页面。

其实我们传统的vue、react做的项目都是把打包好的js和css放到服务端，然后浏览器请求接收到js，然后执行js生成页面的。

浏览器拿到的html文件里面只有一个根元素，其他的页面组件都是执行js生成的

 ### 服务端渲染
 就是在服务端执行js把渲染生成html字符串，浏览器请求接收到的就是我们的页面，这样可以减小浏览器cpu的压力（减少了很多js的执行）

 传统项目的缺点：
 - 1.不利于seo，因为浏览器拿到的是一个个js文件，html里面只要一个根元素。（注意不同爬虫工作原理类似，只会爬取源码，不会执行网站的任何脚本）

 - 2.传统项目都是单页面，想要看到网站就得把所以js文件都执行了，首屏加载时间长；（ssr项目浏览器是node发送过来的html字符串，并不依赖于js文件了，这就会使用户更快的看到页面的内容）

 ssr项目得缺点：

 - 1.大部分得js都在服务端执行，服务端压力较大

 - 2.开发条件受限 （在服务端渲染中，只会执行到componentDidMount之前的生命周期钩子，因此项目引用的第三方的库也不可用其它生命周期钩子，这对引用库的选择产生了很大的限制；）
 
 #### 耗时比较

- 1.由服务端请求首屏数据，而不是客户端请求首屏数据，这是“快”的一个主要原因。服务端在内网进行请求，数据响应速度快。
 
 客户端在不同网络环境进行数据请求，且外网http请求开销大，导致时间差。 

- 2.html渲染
服务端渲染是先向后端服务器请求数据，然后生成完整首屏html返回给浏览器；而客户端渲染是等js代码下载、加载、解析完成后再请求数据渲染，

等待的过程页面是什么都没有的，就是用户看到的白屏。就是服务端渲染不需要等待js代码下载完成并请求数据，就可以返回一个已有完整数据的首屏页面

### 传统项目改造成ssr项目得主要改动

首先我们要明白，不是所有得东西都是服务端生成得。有一部分是和之前一样的，所以我们要设置两个入口，一个是之前的index.js(mian.js这个看自己项目的定义了)，一个server.js（服务端的入口）；

- index.html 同级增加一个index.ssr.html
- webpack配置中，一个webpack.ssrconfig.js和传统得项webpack.config.js
- 在顶层下增加一个server.js文件用node开启一个服务

文件都有了，两个webpack配置文件的入口要改成相对应的index.js和server.js，然后现在是多页面的，代码分割要插件要去掉

然后就是路由页面默认的hash模式得改成history模式，因为hash模式不会请求

然后在package.json里面定义服务端和本地打包得命令

### 注意:
当然不是这样就简单得全部完成了，里面会有一些问题，如绑定得事件无效，原因很简单，react-dom/server 下的 renderToString 并没有做事件相关的处理，因此返回给浏览器的内容不会有事件绑定。

这就需要进行同构了。所谓同构，通俗的讲，就是一套 React 代码在服务器上运行一遍，到达浏览器又运行一遍。服务端渲染完成页面结构，浏览器端渲染完成事件绑定。

在ssr.html页面用一个 script 标签。而它拉取的 JS 代码就是来完成同构的。


当然如果要使用服务端渲染框架就会更简单了 

[vue => nuxt.js](https://zh.nuxtjs.org/)  

[react => next.js](https://nextjs.frontendx.cn/)

