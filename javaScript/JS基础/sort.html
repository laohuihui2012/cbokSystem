<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style type="text/css">
</style>
     
<body>
</body>
<script>
    // let arr = [4, 10, 40, 38, 56, 39, 36, 9];


    // function fastSort(arr) {
    //     let len = arr.length,
    //         preIndex,
    //         current

    //     for (let i = 1; i < arr.length; i++) {
    //        preIndex = i - 1;
    //        current = arr[i];
    //        while(preIndex >= 0 && current < arr[preIndex]){
    //            arr[preIndex + 1] = arr[preIndex];
    //            preIndex--;
    //        }
    //        arr[preIndex + 1] = current;
    //     }
    //     return arr;Str
    // }
    // function defineRactive(data, key ,value) {
    //     Object.defineProprety(data, key, {
    //         enumerable: true,
    //         configurable: true,
    //         set: function setter(params) {
    //             console.log(`get key: ${key}, vaule:${value} `);
    //             return value;
    //         },
    //         get:function getter(newval) {
    //           console.log(`set key:${key}, value:${newval}`); 
    //           value = newval; 
    //         }
    //     })
    // }
    //  function observer(data) {
    //      Object.keys(data).forEach(key => {
    //         defineReactive(data, key, data[key]);
    //      });
    //  }

    
    // function formatNum(num) {
    //     let str = num && num.toString(); // 先转成字符串
    //     let len = str.length;
    //     let decimals = '';
    //     // 判断是否有小数点
    //     str.indexOf('.') > -1 ? decimals = str.split('.')[1] : null;
    //     if(len <= 3) {
    //         return str;
    //     } else {len
    //         let remainder = len % 3,
    //             temp = '';
    //         decimals ? temp = '.' + decimals : null;
    //         if(remainder > 0) { // 长度不是3的整数倍
    //             return str.slice(0, remainder) + ',' + str.slice(remainder, len).match(/\d{3}/g).join(',') + temp;
    //         } else {
    //             return str.slice(0, len).match(/\d{3}/g).join(',') + temp;
    //         }
    //     }
    //    }

    //    console.log(formatNum(2312323.33));  // '2,312,323.33'
    // function sumBigNumber(a, b) {
    //      let res = '',
    //         temp = 0;
    //      a = a.split('');
    //      b = b.split('');
    //      while (a.length || b.length || temp) {
    //         temp += ~~a.pop() + ~~b.pop();
    //         res = (res % 10) + res;
    //         temp = temp > 9;            
    //      }
    //      console.log(res);
    //    } 

    // function sumBigNumber(a, b) {
    //      let res = '',
    //         temp = 0;
    //      a = a.split('');
    //      b = b.split('');
    //      while (a.length || b.length || temp) {
    //         temp += ~~a.pop() + ~~b.pop();
    //         res = (res % 10) + res;
    //         temp = temp > 9;            
    //      }
    //      return res.replace(/^0+/, '');
    //    } 

    // function currying(fn) {
    //     let args = [];
    //     return function temp(...newArgs) {
    //         if( newArgs.length ) {
    //             args = [
    //                 ...args,
    //                 ...newArgs
    //             ];
    //             return temp;
    //         } else {
    //             let res = fn.apply(this, args);
    //             args = [];
    //             return res;
    //         }
    //     }
    // }

    // function add(...args) {
    //     return args.reduce((a, b) => a + b)
    // }

    // let addCurry = currying(add);
    // console.log(addCurry(1)(3,5,56)()) 
    // function add(m) {
    //     let temp = function (n) {
    //         return add(m + n);
    //     };
    //     temp.toString = function () {
    //         return m;
    //     }
    //     return temp;
    // }
    // console.log(add(1)(2)(3));

    // function add() {
    //     // 第一次执行时，定义一个数组专门用来存储所有的参数
    //     var _args = Array.prototype.slice.call(arguments);

    //     // 在内部声明一个函数，利用闭包的特性保存_args并收集所有的参数值
    //     var _adder = function() {
    //         _args.push(...arguments);
    //         return _adder;
    //     };

    //     // 利用toString隐式转换的特性，当最后执行时隐式转换，并计算最终的值返回
    //     _adder.toString = function () {
    //         return _args.reduce(function (a, b) {
    //             return a + b;
    //         });
    //     }
    //     return _adder;
    // }
    

    // function listToTree(data) {
    //     if(!Array.isArray(data)) {
    //         return data;
    //     }
    //     let map = new Map();
    //     data.forEach( item => {
    //         map.set(item.id, item);
    //     })
    //     let res = [];
    //     data.forEach(item => {
    //         let parent = map.get(item.pid);
    //         parent ? (parent.children || (parent.children = [])).push(item) : res.push(item);
    //     })
    //     console.log(res);
    //     return res;
    // }

    // function childNumber(num, count) {
    //     let allChild = [];
    //     for (let i = 0; i < num; i++) {
    //         allChild[i] = i + 1;
    //     }

    //     let leaveCount = 0, // 离开的人数
    //         curIndex = 0, // 当前下标
    //         curCount = 1; // 当前报数
    //      while(leaveCount < num - 1 ) {
    //         if(allChild[curIndex] !== 0) curCount++;

    //         if(curCount === count) { // 当报数的数等于3时，又重开始报数,移除的下标值为0
    //             curCount = 1;
    //             allChild[curIndex] = 0;
    //             leaveCount++;
    //         }
    //         curIndex++;
    //         if(curIndex === num) {
    //             curIndex = 0;
    //         }
    //      }

    //      for (let i = 0; i < num; i++) {
    //         if(allChild[i] !== 0) {
    //             return allChild[i];
    //         }
    //      }
    // }

    // console.log(childNumber(40, 3)); 

    function red() {
        console.log('red');
    }

    function green() {
        console.log('green');
    }

    function yellow() {
        console.log('yellow');
    }
    // function task(color, time, callback) {
    //     setTimeout(() =>{
    //         if(color === 'red') {
    //             red();
    //         } else if(color === 'green') {
    //             green();
    //         } else if(color === 'yellow') {
    //             yellow();
    //         }
    //         callback();
    //     }, time)
    // }

    // const step = () => {
    //     task('red', 3000, () => {
    //         task('green', 2000, () => {
    //             task('yellow', 1000, step);
    //         });
    //     })
    // }
    // step();
    
    // const task = (color, time) => {
    //     return new Promise((resolve, reject) => {
    //         setTimeout(() =>{
    //             if(color === 'red') {
    //                 red();
    //             } else if(color === 'green') {
    //                 green();
    //             } else if(color === 'yellow') {
    //                 yellow();
    //             }
    //             resolve();
    //         }, time)
    //     })
    // }

    // const step = () => {
    //     task('red', 3000)
    //     .then(() => task('green', 2000))
    //     .then(() => task('yellow', 1000))
    //     .then(step)
    // }

    // step()

    // const step = async () => {
    //     await task('red', 3000);
    //     await task('green', 2000);
    //     await task('yellow', 1000);
    //     step()
    // }
    // step()


    // class EventCenter{
    //     // 1. 定义事件容器，用来装事件数组
    //     let handlers = {};

    //     // 2. 添加事件方法，参数：事件名 事件方法
    //     addEventListener(type, handler) {
    //         // 创建新数组容器
    //         if (!this.handlers[type]) {
    //         this.handlers[type] = []
    //         }
    //         // 存入事件
    //         this.handlers[type].push(handler)
    //     }

    //     // 3. 触发事件，参数：事件名 事件参数
    //     dispatchEvent(type, params) {
    //         // 若没有注册该事件则抛出错误
    //         if (!this.handlers[type]) {
    //         return new Error('该事件未注册')
    //         }
    //         // 触发事件
    //         this.handlers[type].forEach(handler => {
    //         handler(...params)
    //         })
    //     }

    //     // 4. 事件移除，参数：事件名 要删除事件，若无第二个参数则删除该事件的订阅和发布
    //     removeEventListener(type, handler) {
    //         if (!this.handlers[type]) {
    //         return new Error('事件无效')
    //         }
    //         if (!handler) {
    //         // 移除事件
    //         delete this.handlers[type]
    //         } else {
    //         const index = this.handlers[type].findIndex(el => el === handler)
    //         if (index === -1) {
    //             return new Error('无该绑定事件')
    //         }
    //         // 移除事件
    //         this.handlers[type].splice(index, 1)
    //             if (this.handlers[type].length === 0) {
    //                 delete this.handlers[type]
    //             }
    //         }
    //     }
    // }
</script>

</html>